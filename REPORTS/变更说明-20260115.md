# 变更说明（2026-01-15）

## 概要
- 清理：移除未使用变量与残留调试输出
- 统一：自定义库解析改用统一存储封装
- 优化：堆叠模拟质量权重预计算，降低重复计算
- 稳定：页面切换时注销旧页面快捷键绑定

## 具体变更
- src/pages/calc/CalcPage.js
  - 删除未使用的 targetWindowWidth/targetWindowHeight 变量（导出图片）
  - 移除底部栏“全部重置”按钮点击的 console.log
  - 参考行：[导出函数](file:///c:/Users/Yang/Documents/Github/Wire-Bundle-Diameter-Calculation/src/pages/calc/CalcPage.js#L448-L457)、[重置点击](file:///c:/Users/Yang/Documents/Github/Wire-Bundle-Diameter-Calculation/src/pages/calc/CalcPage.js#L1069-L1083)
- src/pages/history/HistoryPage.js
  - 移除“清除历史记录”按钮点击的 console.log
  - 参考行：[清除历史](file:///c:/Users/Yang/Documents/Github/Wire-Bundle-Diameter-Calculation/src/pages/history/HistoryPage.js#L189-L204)
- src/logic/wireManager.js
  - getCustomWireLibraries 改为使用 services/storage.getJSON，统一异常与回退
  - 参考行：[wireManager](file:///c:/Users/Yang/Documents/Github/Wire-Bundle-Diameter-Calculation/src/logic/wireManager.js#L12-L28)
- src/pages/Popup.js
  - showPage 切换页面前注销旧页面的全局快捷键绑定
  - 参考行：[showPage](file:///c:/Users/Yang/Documents/Github/Wire-Bundle-Diameter-Calculation/src/pages/Popup.js#L173-L198)
- src/logic/simulationEngine.js
  - 在 packStep 中预计算各圆质量权重（r^WEIGHT_FACTOR），避免每对重复 Math.pow
  - 参考行：[mass 缓存](file:///c:/Users/Yang/Documents/Github/Wire-Bundle-Diameter-Calculation/src/logic/simulationEngine.js#L132-L140)

## 临时测试（将删除）
- tests/simulationEngine.test.js：基础断言（容器半径、返回结构）
- tests/testRunner.html：浏览器模块加载运行器

## 风格与规范
- 维持 2 空格缩进与 ES6 模块
- 不引入新依赖，行为与数据结构不变

## 仓库清理（2026-01-15）
- 忽略规则完善：新增 .gitignore 与更新 .trae/.ignore，排除临时/日志/缓存与常见构建产物目录
- 移除未使用导出：删除 simulationConstants 中 `getWireOdTable`、`getStandardGauges` 导出；同步移除 CalcPage 未使用导入
